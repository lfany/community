# $Id$
# Contributor: Florian Walch <florian+aur@fwalch.com>
# Contributor: Florian Hahn <flo@fhahn.com>

pkgbase=lua-messagepack
pkgname=(lua51-messagepack lua52-messagepack lua-messagepack)
pkgver=0.3.5
pkgrel=1
arch=(any)
url='https://fperrad.github.io/lua-MessagePack'
license=(MIT)
checkdepends=(lua lua-testmore)
source=(lua-messagepack-$pkgver.tar.gz::https://github.com/fperrad/lua-MessagePack/archive/$pkgver.tar.gz)
sha256sums=('6883d4b096c3d8854ec8ddd8ebd72d5c550e9f36c3a1fd1fa56a927786b913d7')

package_lua51-messagepack() {
  pkgdesc='Implementation of MessagePack spec v5 for Lua 5.1'
  depends=(lua51)

  cd lua-MessagePack-${pkgver}
  make LUAVER=5.1 PREFIX=/usr DESTDIR="$pkgdir" install
  install -Dm644 COPYRIGHT "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}

package_lua52-messagepack() {
  pkgdesc='Implementation of MessagePack spec v5 for Lua 5.2'
  depends=(lua52)

  cd lua-MessagePack-$pkgver
  make LUAVER=5.2 PREFIX=/usr DESTDIR="$pkgdir" install
  install -Dm644 COPYRIGHT "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}

package_lua-messagepack() {
  pkgdesc='Implementation of MessagePack spec v5 for Lua 5.3'
  depends=(lua)

  cd lua-MessagePack-$pkgver
  make LUAVER=5.3 PREFIX=/usr DESTDIR="$pkgdir" install
  install -Dm644 COPYRIGHT "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}

check() {
  cd lua-MessagePack-$pkgver
  make check
}

